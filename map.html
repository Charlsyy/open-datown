<!DOCTYPE html>
<html>
<head>
	
	<title>open da<b>town</b></title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>
	<link rel="stylesheet" type="text/css" href="map.css"></link>
</head>
<body>
	
	<h1><u>Point Stuff Out Map</u></h1>
	
	<div id="wrapper">	
	<div id="mapid">
<script>
	var markerdescription;
	function getcoords() {
		var latitude = window.ltlg.lat;
		var longitude = window.ltlg.long;
		console.log(latitude);
	}

	function getTag() {
		var input = document.getElementById("usertag");	
		var value = input.value
		console.log(value)
		markerdescription = value;
		return value
	}
		var mymap = L.map('mapid').setView([51.505, -0.09], 13);
	if (navigator.geolocation) {
		navigator.geolocation.getCurrentPosition(setPosition);
    } else { 
		mymap = L.map('mapid').setView([51.505, -0.09], 13);
    }
	
	function setPosition(position){
		mymap.setView([position.coords.latitude, position.coords.longitude], 13);
	var circle = L.circle([position.coords.latitude, position.coords.longitude], {
    color: 'red',
    fillColor: '#f03',
    fillOpacity: 0.5,
    radius: 100
	}).addTo(mymap);
	circle.bindPopup("current location");
	}

	L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox.streets'
	}).addTo(mymap);

	var popup = L.popup();
	var latlng;
	var markerGroup = L.layerGroup().addTo(mymap);

        function onMapClick(e) {
	        latlng = e.latlng;
		window.ltlg = e.latlng;
	        popup
				.setLatLng(e.latlng)
				.setContent("<input type='text' id='usertag'/> <button type='submit' onclick='getcoords();getTag();mymap.closePopup();setMarker()'> Hinzufügen </button>")
				.openOn(mymap);
                                
        }

        function setMarker(){
            var marker = L.marker(latlng).addTo(mymap)
                .bindPopup(markerdescription);
		marker.addTo(markerGroup)
		marker.on('click', onClick_Marker);
                        mymap.closePopup();
        }
		
	function setMarkerManuel(lat, lng, type){
		var marker = L.marker([lat, lng]).addTo(mymap)
                	.bindPopup(type);
            mymap.closePopup();
		}	
		
	mymap.on('click', onMapClick);
	
	function onClick_Marker(e) {
		console.log(e);
		lfid = e.target._leaflet_id;
	}
	
	function removeMarker(leafletid) {
		markerGroup.removeLayer(leafletid);
	}


</script>
	</div>
	<div id="textfenster">
	<p> Hier könnte ihre Werbung stehen</p>
	</div>
	</div>	

</body>
</html>

